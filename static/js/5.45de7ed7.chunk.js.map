{"version":3,"sources":["Common/MessagesList/MessagesList.tsx","components/Chat/ChatMessages.tsx","Pages/ChatPage.tsx"],"names":["MessagesList","props","messages","isMessageSentFetching","useSelector","getIsMessageSentFetchingSelector","messagesRef","React","useRef","useState","isAutoscroll","setIsAutoscroll","useEffect","setTimeout","current","scrollIntoView","behavior","block","style","height","overflowY","width","onScroll","event","element","currentTarget","scrollHeight","scrollTop","clientHeight","notCentered","ref","ChatMessages","getChatMessages","ownerId","getOwnerIdSelector","messagesComponentsList","map","messageItem","Post","postId","id","action","PostActions","onlyText","message","avatar","photo","userName","userId","rightSided","withAuthRedirect","dispatch","useDispatch","isConnected","getIsChatConnectedSelector","startMessagesListening","stopMessagesListening","Divider","AddMessageForm","blockWidth","sendMessage","buttonText","minTextLength","maxTextLength","isBlocked"],"mappings":"8MAmBaA,EAAgD,SAACC,GAC1D,IAAOC,EAAYD,EAAZC,SACDC,EAAwBC,YAAYC,KACpCC,EAAcC,IAAMC,OAAsB,MAChD,EAAwCD,IAAME,UAAS,GAAvD,mBAAOC,EAAP,KAAqBC,EAArB,KAwBA,OARAJ,IAAMK,WAAU,WACRF,GACAG,YAAW,WAAO,IAAD,EACb,UAAAP,EAAYQ,eAAZ,SAAqBC,eAAe,CAACC,SAAU,SAAUC,MAAO,UACjE,OAER,CAACf,EAAUQ,IAGV,eAAC,IAAD,CAAMQ,MAAO,CAACC,OAAQlB,EAAMkB,OAAQC,UAAW,OAAQC,MAAO,QAASC,SAnB3E,SAAuBC,GACnB,IAAMC,EAAUD,EAAME,cAEjBD,EAAQE,aAAeF,EAAQG,YAAeH,EAAQI,cACtDlB,GAAgBC,GAAgB,GAEjCD,GAAgBC,GAAgB,IAapC,UACKT,EACAC,GAAyB,6BAAI,cAAC,IAAD,CAAW0B,aAAa,MACtD,oBAAIC,IAAKxB,S,8GCxCRyB,EAAyB,WAClC,IAAM7B,EAAWE,YAAY4B,KACvBC,EAAU7B,YAAY8B,KAExBC,EAAyBjC,EAASkC,KAAI,SAACC,GAAD,OACtC,cAACC,EAAA,EAAD,CACMC,OAAQF,EAAYG,GACpBC,OAAQC,IAAYC,SAASN,EAAYO,SACzCC,OAAQR,EAAYS,MACpBC,SAAUV,EAAYU,SACtBC,OAAQX,EAAYW,OACpBC,WAAYZ,EAAYW,SAAWf,GAN9B,UAAYI,EAAYG,OASvC,OACI,cAACxC,EAAA,EAAD,CAAcE,SAAUiC,EAAwBhB,OAAQ,U,2BCsBjD+B,uBA3BY,WACvB,IAAMC,EAAWC,cACXC,EAAcjD,YAAYkD,KAUhC,OARA1C,qBAAU,WAEN,OADAuC,EAASI,eACF,WACHJ,EAASK,kBAGd,IAGC,gCACI,cAAC,EAAD,IACA,cAACC,EAAA,EAAD,IACA,cAACC,EAAA,EAAD,CAAgBC,WAvBV,OAwBUC,YAAaA,IACbC,WAAW,OACXC,cAAe,EACfC,cAAe,IACfC,WAAYX","file":"static/js/5.45de7ed7.chunk.js","sourcesContent":["import React from 'react';\nimport List from '@material-ui/core/List';\nimport {useSelector} from 'react-redux';\nimport {getIsMessageSentFetchingSelector} from '../Selectors/Selectors';\nimport Preloader from '../Preloader/Preloader';\n\ntype messagesListPropsType = {\n    messages: Array<JSX.Element>,\n    height: string\n}\n\n/**\n * Returns list of messages width autoscroll functionality.\n * If list scrolled to bottom list will autoscroll.\n * @param {messagesListPropsType} props - props object.\n * @param {Array<JSX.Element>} props.messages - array of messages as JSX.\n * @param {string} props.height - CSS string value for height (i.e. \"10px\").\n * @constructor\n */\nexport const MessagesList: React.FC<messagesListPropsType> = (props) => {\n    const {messages} = props;\n    const isMessageSentFetching = useSelector(getIsMessageSentFetchingSelector);\n    const messagesRef = React.useRef<HTMLLIElement>(null);\n    const [isAutoscroll, setIsAutoscroll] = React.useState(true);\n\n    /**\n     * Detects scroll end and set autoscroll to true or false.\n     * @param event\n     */\n    function scrollHandler(event: React.UIEvent<HTMLUListElement, UIEvent>) {\n        const element = event.currentTarget;\n\n        if ((element.scrollHeight - element.scrollTop) === element.clientHeight) {\n            !isAutoscroll && setIsAutoscroll(true);\n        } else {\n            isAutoscroll && setIsAutoscroll(false);\n        }\n    }\n\n    React.useEffect(() => {\n        if (isAutoscroll) {\n            setTimeout(() => {\n                messagesRef.current?.scrollIntoView({behavior: 'smooth', block: 'end'});\n            }, 500);\n        }\n    }, [messages, isAutoscroll]);\n\n    return (\n        <List style={{height: props.height, overflowY: 'auto', width: '100%'}} onScroll={scrollHandler}>\n            {messages}\n            {isMessageSentFetching && <li><Preloader notCentered={true}/></li>}\n            <li ref={messagesRef}/>\n        </List>\n    );\n}","import React from 'react';\nimport {useSelector} from 'react-redux';\nimport {getChatMessages, getOwnerIdSelector} from '../../Common/Selectors/Selectors';\nimport Post from '../../Common/Post/Post';\nimport {PostActions} from '../../Common/Post/PostActions/PostActions';\nimport {MessagesList} from '../../Common/MessagesList/MessagesList';\n\n/**\n * Returns block with list of messages.\n * @constructor\n */\nexport const ChatMessages: React.FC = () => {\n    const messages = useSelector(getChatMessages);\n    const ownerId = useSelector(getOwnerIdSelector);\n\n    let messagesComponentsList = messages.map((messageItem) =>\n        <Post key={'Message' + messageItem.id}\n              postId={messageItem.id}\n              action={PostActions.onlyText(messageItem.message)}\n              avatar={messageItem.photo}\n              userName={messageItem.userName}\n              userId={messageItem.userId}\n              rightSided={messageItem.userId === ownerId}\n        />);\n\n    return (\n        <MessagesList messages={messagesComponentsList} height={'65vh'}/>\n    );\n};\n","import React, {useEffect} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {sendMessage, startMessagesListening, stopMessagesListening} from '../reducers/chatReducer';\nimport {ChatMessages} from '../components/Chat/ChatMessages';\nimport Divider from '@material-ui/core/Divider';\nimport {AddMessageForm} from '../Common/AddMessageForm/AddMessageForm';\nimport {getIsChatConnectedSelector} from '../Common/Selectors/Selectors';\nimport withAuthRedirect from '../Hocs/withAuthRedirect';\n\n/**\n * @const\n * @type string\n * @description block max width.\n */\nconst MAX_WIDTH = '30ch';\n\n/**\n * Returns whole page of chat.\n * Available only for authorized users.\n * @constructor\n */\nconst ChatPage: React.FC = () => {\n    const dispatch = useDispatch();\n    const isConnected = useSelector(getIsChatConnectedSelector);\n\n    useEffect(() => {\n        dispatch(startMessagesListening());\n        return () => {\n            dispatch(stopMessagesListening());\n        }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    return(\n        <div>\n            <ChatMessages/>\n            <Divider/>\n            <AddMessageForm blockWidth={MAX_WIDTH}\n                            sendMessage={sendMessage}\n                            buttonText='Send'\n                            minTextLength={2}\n                            maxTextLength={100}\n                            isBlocked={!isConnected}\n            />\n        </div>\n    );\n}\n\nexport default withAuthRedirect(ChatPage);"],"sourceRoot":""}