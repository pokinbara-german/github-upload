{"version":3,"sources":["Common/MessagesList/MessagesList.tsx","../node_modules/@material-ui/icons/ChevronLeft.js","components/Dialogs/NoDialog/NoDialog.tsx","components/Dialogs/Dialog/MoreDialogMessagesButton/MoreDialogMessagesButton.tsx","components/Dialogs/Dialog/GoBackButton/GoBackButton.tsx","components/Dialogs/Dialog/EmptyMessagesList/EmptyMessagesList.tsx","components/Dialogs/Dialog/Dialog.tsx","components/Dialogs/DialogsList/DialogsList.tsx","components/Dialogs/Dialogs.tsx"],"names":["MessagesList","props","messages","isMessageSentFetching","useSelector","getIsMessageSentFetchingSelector","messagesRef","React","useRef","useState","isAutoscroll","setIsAutoscroll","useEffect","setTimeout","current","scrollIntoView","behavior","block","style","height","overflowY","width","onScroll","event","element","currentTarget","scrollHeight","scrollTop","clientHeight","notCentered","ref","_interopRequireDefault","require","_interopRequireWildcard","Object","defineProperty","exports","value","default","_default","createElement","d","NoDialog","classes","makeStyles","theme","createStyles","helperText","display","flexGrow","alignItems","justifyContent","breakpoints","down","useStyles","Container","className","Typography","variant","color","MoreDialogMessagesButton","dispatch","useDispatch","Button","onClick","getMessagesList","currentDialogId","goBackButtonWrapper","up","GoBackButton","history","useHistory","IconButton","push","getRouteNameById","routes","dialogs","id","Divider","EmptyMessagesList","emptyMessages","flexDirection","BLOCK_HEIGHT","margin","spacing","Dialog","getDialogsMessagesSelector","opponents","getDialogsUserListSelector","ownerId","getOwnerIdSelector","ownerPhoto","getOwnerPhotosSelector","small","hasMore","getDialogHasMoreSelector","isMessagesFetching","getIsMessagesFetchingSelector","opponent","dialogId","filter","user","undefined","length","getOpponentData","opponentPhoto","photos","hasNewMessages","dialogsActions","chatMessagesRead","messagesComponentsList","map","message","isOwner","senderId","action","viewed","PostActions","textWithOk","body","addedAt","textWithWait","onlyText","Post","postId","avatar","userName","rightSided","unshift","Preloader","AddMessageForm","blockWidth","sendMessage","buttonText","minTextLength","dialogsItems","DialogsList","userList","users","newMessagesCount","Counter","count","inCorner","String","userId","primaryLink","List","withRouter","withAuthRedirect","isDialogsFetching","getIsDialogsFetchingSelector","match","params","parseInt","dialogsWrapper","emptyDialogsList","minWidth","chatChanged","getDialogsList","orientation"],"mappings":"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","file":"static/js/4.858f4e40.chunk.js","sourcesContent":["import React from 'react';\nimport List from '@material-ui/core/List';\nimport {useSelector} from 'react-redux';\nimport {getIsMessageSentFetchingSelector} from '../Selectors/Selectors';\nimport Preloader from '../Preloader/Preloader';\n\ntype messagesListPropsType = {\n    messages: Array<JSX.Element>,\n    height: string\n}\n\n/**\n * Returns list of messages width autoscroll functionality.\n * If list scrolled to bottom list will autoscroll.\n * @param {messagesListPropsType} props - props object.\n * @param {Array<JSX.Element>} props.messages - array of messages as JSX.\n * @param {string} props.height - CSS string value for height (i.e. \"10px\").\n * @constructor\n */\nexport const MessagesList: React.FC<messagesListPropsType> = (props) => {\n    const {messages} = props;\n    const isMessageSentFetching = useSelector(getIsMessageSentFetchingSelector);\n    const messagesRef = React.useRef<HTMLLIElement>(null);\n    const [isAutoscroll, setIsAutoscroll] = React.useState(true);\n\n    /**\n     * Detects scroll end and set autoscroll to true or false.\n     * @param event\n     */\n    function scrollHandler(event: React.UIEvent<HTMLUListElement, UIEvent>) {\n        const element = event.currentTarget;\n\n        if ((element.scrollHeight - element.scrollTop) === element.clientHeight) {\n            !isAutoscroll && setIsAutoscroll(true);\n        } else {\n            isAutoscroll && setIsAutoscroll(false);\n        }\n    }\n\n    React.useEffect(() => {\n        if (isAutoscroll) {\n            setTimeout(() => {\n                messagesRef.current?.scrollIntoView({behavior: 'smooth', block: 'end'});\n            }, 500);\n        }\n    }, [messages, isAutoscroll]);\n\n    return (\n        <List style={{height: props.height, overflowY: 'auto', width: '100%'}} onScroll={scrollHandler}>\n            {messages}\n            {isMessageSentFetching && <li><Preloader notCentered={true}/></li>}\n            <li ref={messagesRef}/>\n        </List>\n    );\n}","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\"\n}), 'ChevronLeft');\n\nexports.default = _default;","import React from 'react';\nimport {createStyles, makeStyles, Theme} from '@material-ui/core';\nimport Container from '@material-ui/core/Container';\nimport Typography from '@material-ui/core/Typography';\n\n/**\n * Empty block with helper text for dialogs page.\n * @constructor\n */\nexport const NoDialog: React.FC = () => {\n    const useStyles = makeStyles((theme: Theme) =>\n        createStyles({\n            helperText: {\n                display: 'flex',\n                flexGrow: 1,\n                alignItems: 'center',\n                justifyContent: 'center',\n                [theme.breakpoints.down('xs')]: {\n                    display: 'none'\n                }\n            }\n        }),\n    );\n\n    const classes = useStyles();\n\n    return (\n        <Container className={classes.helperText}>\n            <Typography variant='h4' color='textSecondary'>Please click on user name to start dialog</Typography>\n        </Container>\n    );\n}","import React from 'react';\nimport {useDispatch} from 'react-redux';\nimport {getMessagesList} from '../../../../reducers/dialogsReducer';\nimport Button from '@material-ui/core/Button';\n\ntype moreDialogMessagesButtonPropsType = {\n    currentDialogId: number\n}\n\n/**\n * Returns complete button for request next page of messages.\n * @param {moreDialogMessagesButtonPropsType} props - props object\n * @param {number} props.currentDialogId - ID of opponent profile\n * @constructor\n */\nexport const MoreDialogMessagesButton: React.FC<moreDialogMessagesButtonPropsType> = (props) => {\n    const dispatch = useDispatch();\n\n    function onClick() {\n        dispatch(getMessagesList(props.currentDialogId));\n    }\n\n    return (\n        <li style={{display: 'flex', justifyContent: 'center'}}>\n            <Button variant='outlined' color='primary' onClick={onClick}>More messages</Button>\n        </li>\n    );\n}","import React from 'react';\nimport {useHistory} from 'react-router-dom';\nimport {getRouteNameById, routes} from '../../../../Common/Routes';\nimport IconButton from '@material-ui/core/IconButton';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport Divider from '@material-ui/core/Divider';\nimport {createStyles, makeStyles, Theme} from '@material-ui/core';\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        goBackButtonWrapper: {\n            [theme.breakpoints.up('sm')]: {\n                display: 'none',\n            },\n        }\n    })\n);\n\n/**\n * Returns complete button for redirect to dialogs root.\n * @returns {JSX.Element}\n * @constructor\n */\nexport const GoBackButton: React.FC = () => {\n    const history = useHistory();\n    const classes = useStyles();\n\n    function closeDialog() {\n        history.push(`/${getRouteNameById(routes.dialogs.id)}`);\n    }\n\n    return (\n        <div className={classes.goBackButtonWrapper}>\n            <IconButton onClick={closeDialog}>\n                <ChevronLeftIcon/>\n            </IconButton>\n            <Divider/>\n        </div>\n    );\n}","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport {createStyles, makeStyles} from '@material-ui/core';\n\ntype emptyMessagesPropsType = {\n    height: string\n}\n\n/**\n * Returns block with helper text.\n * @param {emptyMessagesPropsType} props - props object.\n * @param {string} props.height - CSS string value for height (i.e. \"10px\").\n * @returns {JSX.Element}\n * @constructor\n */\nexport const EmptyMessagesList: React.FC<emptyMessagesPropsType> = (props) => {\n    const useStyles = makeStyles(() =>\n        createStyles({\n            emptyMessages: {\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                justifyContent: 'center',\n                height: props.height\n            }\n        })\n    );\n\n    const classes = useStyles();\n\n    return (\n        <div className={classes.emptyMessages}>\n            <Typography color='textSecondary' variant='h4'>No messages yet</Typography>\n            <Typography color='textSecondary' variant='h4'>send something to your opponent</Typography>\n        </div>\n    );\n}","import React from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {\n    getDialogHasMoreSelector,\n    getDialogsMessagesSelector,\n    getDialogsUserListSelector,\n    getIsMessagesFetchingSelector,\n    getOwnerIdSelector,\n    getOwnerPhotosSelector\n} from '../../../Common/Selectors/Selectors';\nimport Post from '../../../Common/Post/Post';\nimport Divider from '@material-ui/core/Divider';\nimport {AddMessageForm} from '../../../Common/AddMessageForm/AddMessageForm';\nimport {dialogsActions, sendMessage} from '../../../reducers/dialogsReducer';\nimport {PostActions} from '../../../Common/Post/PostActions/PostActions';\nimport {MessagesList} from '../../../Common/MessagesList/MessagesList';\nimport {createStyles, makeStyles, Theme} from '@material-ui/core';\nimport {userListType} from '../../../types';\nimport {MoreDialogMessagesButton} from './MoreDialogMessagesButton/MoreDialogMessagesButton';\nimport {GoBackButton} from './GoBackButton/GoBackButton';\nimport {EmptyMessagesList} from './EmptyMessagesList/EmptyMessagesList';\nimport Preloader from '../../../Common/Preloader/Preloader';\n\ntype dialogPropsType = {\n    currentDialogId: number\n}\n\n/**\n * @const\n * @type string\n * @description height of block.\n */\nconst BLOCK_HEIGHT = '70vh';\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        messages: {\n            flexGrow: 1,\n            width: '20%',\n            margin: theme.spacing(3),\n        }\n    })\n);\n\n/**\n * Returns opponent data.\n * @param {Array<userListType>} opponents - list of dialogs\n * @param {number} dialogId - profile ID of opponent.\n */\nfunction getOpponentData(opponents: Array<userListType>, dialogId: number):userListType|null  {\n    let opponent = opponents.filter(user => {\n        return user.id === dialogId ? user as userListType : undefined;\n    });\n\n    return opponent.length ? opponent[0] : null;\n}\n\n/**\n * Returns block of dialog with list of messages and form to add new.\n * @returns {JSX.Element}\n * @constructor\n */\nexport const Dialog: React.FC<dialogPropsType> = (props) => {\n    let {currentDialogId} = props;\n    const messages = useSelector(getDialogsMessagesSelector);\n    const opponents = useSelector(getDialogsUserListSelector);\n    const ownerId = useSelector(getOwnerIdSelector);\n    const ownerPhoto = useSelector(getOwnerPhotosSelector)?.small;\n    const hasMore = useSelector(getDialogHasMoreSelector);\n    const isMessagesFetching = useSelector(getIsMessagesFetchingSelector);\n    const classes = useStyles();\n    const dispatch = useDispatch();\n\n    const opponent = getOpponentData(opponents, currentDialogId);\n    const opponentPhoto = opponent ? opponent.photos.small : null;\n\n    React.useEffect(() => {\n        if (!currentDialogId || !opponent){\n            return;\n        }\n\n        if (opponent.hasNewMessages) {\n            dispatch(dialogsActions.chatMessagesRead(currentDialogId));\n        }\n    }, [currentDialogId, dispatch, opponent]);\n\n    let messagesComponentsList = messages.map(message => {\n        const isOwner = message.senderId === ownerId;\n        const action = isOwner\n            ? (message.viewed\n                ? PostActions.textWithOk(message.body, message.addedAt)\n                : PostActions.textWithWait(message.body, message.addedAt)\n              )\n            : PostActions.onlyText(message.body, message.addedAt);\n\n        return <Post key={'Message' + message.id}\n                     postId={message.id}\n                     action={action}\n                     avatar={!isOwner ? opponentPhoto : ownerPhoto || null}\n                     userName={''}\n                     rightSided={isOwner}\n        />\n    });\n\n    if (hasMore) {\n        messagesComponentsList.unshift(\n            isMessagesFetching ? <Preloader/> : <MoreDialogMessagesButton key={'MoreMessagesButton'} currentDialogId={currentDialogId}/>\n        );\n    }\n\n    return (\n        <div className={classes.messages}>\n            <GoBackButton/>\n            {messages.length\n                ? <MessagesList messages={messagesComponentsList} height={BLOCK_HEIGHT}/>\n                : isMessagesFetching\n                    ? <div style={{height: BLOCK_HEIGHT}}><Preloader/></div>\n                    : <EmptyMessagesList height={BLOCK_HEIGHT}/>\n            }\n            <Divider/>\n            <AddMessageForm blockWidth={'30ch'}\n                            sendMessage={sendMessage}\n                            buttonText='Send'\n                            minTextLength={2}\n            />\n        </div>\n    );\n}","import React from 'react';\nimport {useSelector} from 'react-redux';\nimport {getDialogsUserListSelector} from '../../../Common/Selectors/Selectors';\nimport {Counter} from '../../../Common/Counter/Counter';\nimport Post from '../../../Common/Post/Post';\nimport List from '@material-ui/core/List';\nimport {createStyles, makeStyles} from '@material-ui/core';\n\ntype dialogsListPropsType = {\n    currentDialogId: number\n}\n\nconst useStyles = makeStyles(() =>\n    createStyles({\n        dialogsItems: {\n            height: '90vh',\n            overflowY: 'auto',\n            flexGrow: 1,\n            '& > li > div': {\n                flexGrow: 1,\n            }\n        }\n    }),\n);\n\n/**\n * Returns complete block with list of dialogs.\n * @param {dialogsListPropsType} props - props object\n * @param {number} props.currentDialogId - props object\n * @returns {JSX.Element}\n * @constructor\n */\nexport const DialogsList: React.FC<dialogsListPropsType> = (props) => {\n    const userList = useSelector(getDialogsUserListSelector);\n    const classes = useStyles();\n\n    let users = userList.map((user) => {\n        let action = user.newMessagesCount > 0 ? <Counter count={user.newMessagesCount} inCorner={true}/> : undefined;\n\n        return <Post key={'User' + user.id}\n                     postId={String(user.id)}\n                     avatar={user.photos.small}\n                     userName={user.userName}\n                     userId={user.id}\n                     primaryLink={user.id !== props.currentDialogId}\n                     action={action}\n        />\n    });\n\n    return (\n        <List className={classes.dialogsItems}>\n            {users}\n        </List>\n    );\n}","/* \n * To change this license header, choose License Headers in Project Properties.\n * To change this template file, choose Tools | Templates\n * and open the template in the editor.\n */\nimport React from 'react';\nimport {dialogsActions, getDialogsList, getMessagesList} from '../../reducers/dialogsReducer';\nimport Divider from '@material-ui/core/Divider';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {RouteComponentProps, withRouter} from 'react-router-dom';\nimport {MatchParams} from '../../types';\nimport {NoDialog} from './NoDialog/NoDialog';\nimport {Dialog} from './Dialog/Dialog';\nimport {createStyles, makeStyles, Theme} from '@material-ui/core';\nimport {getIsDialogsFetchingSelector} from '../../Common/Selectors/Selectors';\nimport withAuthRedirect from '../../Hocs/withAuthRedirect';\nimport Preloader from '../../Common/Preloader/Preloader';\nimport {DialogsList} from './DialogsList/DialogsList';\n\ntype matchType = RouteComponentProps<MatchParams>;\n\n/**\n * Returns page with dialogs.\n * Allow only for authorized users.\n * @param {Object} props - props object\n * @param {matchType} props.match - props from router\n * @returns {JSX.Element}\n * @constructor\n */\nconst Dialogs: React.FC<matchType> = (props) => {\n    const isDialogsFetching = useSelector(getIsDialogsFetchingSelector);\n    const dispatch = useDispatch();\n    const currentDialogId = props.match.params.userId ? parseInt(props.match.params.userId) : 0;\n\n    const useStyles = makeStyles((theme: Theme) =>\n        createStyles({\n            dialogsWrapper: {\n                display: 'flex',\n                margin: theme.spacing(-3)\n            },\n            dialogs: {\n                display: 'flex',\n                [theme.breakpoints.down('xs')]: {\n                    display: currentDialogId ? 'none' : 'flex',\n                    width: '100%'\n                },\n            },\n            emptyDialogsList: {\n                minWidth: 200\n            }\n        }),\n    );\n\n    const classes = useStyles();\n\n    React.useEffect(() => {\n        if (currentDialogId) {\n            dispatch(dialogsActions.chatChanged(currentDialogId));\n            dispatch(getMessagesList(currentDialogId));\n        }\n    }, [currentDialogId, dispatch]);\n\n    React.useEffect(() => {\n        dispatch(getDialogsList());\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    return (\n        <div className={classes.dialogsWrapper}>\n            <div className={classes.dialogs}>\n                {isDialogsFetching\n                    ? <div className={classes.emptyDialogsList}><Preloader/></div>\n                    : <DialogsList currentDialogId={currentDialogId}/>\n                }\n                <Divider orientation='vertical'/>\n            </div>\n            {currentDialogId\n                ? <Dialog currentDialogId={currentDialogId}/>\n                : <NoDialog/>\n            }\n        </div>\n    );\n};\n\nexport default withRouter(withAuthRedirect(Dialogs));"],"sourceRoot":""}